# æ§åˆ¶å°å¯¼èˆªéªŒè¯ä¿®å¤æ€»ç»“

## é—®é¢˜æè¿°

ç”¨æˆ·å‘ç°WhatNoteæ§åˆ¶å°ç³»ç»Ÿå­˜åœ¨ä¸¥é‡çš„éªŒè¯é—®é¢˜ï¼š

1. **è™šå‡å¯¼èˆªå“åº”** - è¾“å…¥ä¸å­˜åœ¨çš„æ–‡ä»¶å¤¹ã€å±•æ¿ã€PDFæ—¶ï¼Œç¨‹åºæ˜¾ç¤º"å·²æ‰“å¼€"ã€"å·²è¿›å…¥"ç­‰ï¼Œä½†å®é™…ä¸Šè¿™äº›èµ„æºå¹¶ä¸å­˜åœ¨
2. **é”™è¯¯çš„åˆ›å»ºä½ç½®** - åœ¨æŸä¸ªè¯¾ç¨‹æ–‡ä»¶å¤¹ä¸‹æ–°å»ºå±•æ¿æ—¶ï¼Œå®é™…ä¸Šåˆ›å»ºçš„æ˜¯æ–‡ä»¶å¤¹è€Œä¸æ˜¯å±•æ¿
3. **è·¯å¾„ä¸Šä¸‹æ–‡ä¸¢å¤±** - åˆ›å»ºæ“ä½œæ²¡æœ‰ä½¿ç”¨å½“å‰è·¯å¾„ä¸Šä¸‹æ–‡ï¼Œå¯¼è‡´åœ¨é”™è¯¯çš„ä½ç½®æ‰§è¡Œ

## æ ¹æœ¬åŸå› åˆ†æ

### 1. Board Createå‘½ä»¤çš„é—®é¢˜

**é—®é¢˜ä»£ç **ï¼š
```python
# é”™è¯¯ï¼šæ€»æ˜¯ä½¿ç”¨ç©ºå­—ç¬¦ä¸²ä½œä¸ºcourse_folder
if app_state.board_exists(board_name, ""):
    # ...
board = app_state.add_board(board_name, "")
```

**åŸå› **ï¼š`board create`å‘½ä»¤æ²¡æœ‰ä½¿ç”¨å½“å‰è·¯å¾„ä¸Šä¸‹æ–‡æ¥ç¡®å®šåº”è¯¥åœ¨å“ªä¸ªè¯¾ç¨‹ä¸‹åˆ›å»ºå±•æ¿ï¼Œæ€»æ˜¯ä¼ é€’ç©ºå­—ç¬¦ä¸²ï¼Œå¯¼è‡´å±•æ¿è¢«åˆ›å»ºåˆ°æ ¹ç›®å½•ã€‚

### 2. éªŒè¯é€»è¾‘ä¸ä¸¥æ ¼

**é—®é¢˜ä»£ç **ï¼š
```python
# Board open - æ”¯æŒæ¨¡ç³ŠåŒ¹é…ï¼Œå³ä½¿æ‰¾ä¸åˆ°ä¹Ÿå¯èƒ½è¿”å›é”™è¯¯çš„ç»“æœ
if board['name'] == board_name or board['name'].lower() == board_name.lower():
    # ç›´æ¥è¿”å›æˆåŠŸï¼Œæ²¡æœ‰ä¸¥æ ¼éªŒè¯
```

**åŸå› **ï¼šå„ç§open/cdå‘½ä»¤çš„éªŒè¯é€»è¾‘ä¸å¤Ÿä¸¥æ ¼ï¼Œå®¹æ˜“äº§ç”Ÿè¯¯å¯¼æ€§çš„æˆåŠŸå“åº”ã€‚

## ä¿®å¤æ–¹æ¡ˆ

### 1. Board Createå‘½ä»¤ä¿®å¤

#### ä¿®å¤åçš„ä»£ç 
```python
elif action == "create":
    # ... è§£æå‚æ•° ...
    
    # æ ¹æ®å½“å‰è·¯å¾„ä¸Šä¸‹æ–‡ç¡®å®šè¯¾ç¨‹åç§°
    path_type = current_path.get('context', {}).get('type', 'root') if current_path else 'root'
    course_folder = ""
    
    if path_type == 'course':
        # åœ¨è¯¾ç¨‹ç›®å½•ä¸­ï¼Œä½¿ç”¨å½“å‰è¯¾ç¨‹åç§°
        course_folder = current_path.get('context', {}).get('courseName', '')
        
        # éªŒè¯è¯¾ç¨‹æ˜¯å¦çœŸå®å­˜åœ¨
        course_folders = app_state.get_course_folders()
        course_exists = any(folder['name'] == course_folder for folder in course_folders)
        
        if not course_exists:
            return {
                "response": f"é”™è¯¯ï¼šå½“å‰è¯¾ç¨‹ '{course_folder}' ä¸å­˜åœ¨ï¼Œæ— æ³•åˆ›å»ºå±•æ¿", 
                "type": "error",
                "style": "color: #ff6b6b; background: transparent;"
            }
    
    # æ£€æŸ¥å±•æ¿æ˜¯å¦å·²å­˜åœ¨ï¼ˆåœ¨æŒ‡å®šè¯¾ç¨‹ä¸­ï¼‰
    if app_state.board_exists(board_name, course_folder):
        scope_msg = f"è¯¾ç¨‹ '{course_folder}' ä¸­" if course_folder else "ç³»ç»Ÿä¸­"
        return {
            "response": f"å±•æ¿ '{board_name}' åœ¨{scope_msg}å·²å­˜åœ¨", 
            "type": "error",
            "style": "color: #ff6b6b; background: transparent;"
        }
    
    # åˆ›å»ºå±•æ¿
    board = app_state.add_board(board_name, course_folder)
    app_state.save_state()
    
    location_msg = f"è¯¾ç¨‹ '{course_folder}' ä¸‹" if course_folder else "æ ¹ç›®å½•ä¸‹"
    return {
        "response": f"âœ… å±•æ¿ '{board_name}' åœ¨{location_msg}åˆ›å»ºæˆåŠŸ", 
        "type": "success",
        "style": "color: #51cf66; background: transparent;",
        "refresh_needed": True
    }
```

#### ä¿®å¤è¦ç‚¹
- **ä½¿ç”¨å½“å‰è·¯å¾„ä¸Šä¸‹æ–‡** - æ ¹æ®`current_path`ç¡®å®šåº”è¯¥åœ¨å“ªä¸ªè¯¾ç¨‹ä¸‹åˆ›å»ºå±•æ¿
- **éªŒè¯è¯¾ç¨‹å­˜åœ¨æ€§** - ç¡®ä¿å½“å‰è¯¾ç¨‹çœŸå®å­˜åœ¨ï¼Œé¿å…åœ¨è™šå‡è·¯å¾„ä¸‹åˆ›å»º
- **ç²¾ç¡®çš„å­˜åœ¨æ€§æ£€æŸ¥** - åœ¨æŒ‡å®šè¯¾ç¨‹èŒƒå›´å†…æ£€æŸ¥å±•æ¿æ˜¯å¦å·²å­˜åœ¨
- **æ˜ç¡®çš„ä½ç½®æç¤º** - åœ¨å“åº”ä¸­æ˜ç¡®è¯´æ˜å±•æ¿åˆ›å»ºçš„ä½ç½®

### 2. Board Openå‘½ä»¤ä¿®å¤

#### ä¿®å¤åçš„ä»£ç 
```python
elif action == "open":
    # ... è§£æå‚æ•° ...
    
    boards = app_state.get_boards()
    
    # æŸ¥æ‰¾å±•æ¿ - åªæ”¯æŒç²¾ç¡®åŒ¹é…
    target_board = None
    for board in boards:
        if board['name'] == board_name:
            target_board = board
            break
    
    # å¦‚æœç²¾ç¡®åŒ¹é…å¤±è´¥ï¼Œå°è¯•ä¸åŒºåˆ†å¤§å°å†™çš„åŒ¹é…
    if not target_board:
        for board in boards:
            if board['name'].lower() == board_name.lower():
                target_board = board
                break
    
    if target_board:
        return {
            "response": f"æ‰“å¼€å±•æ¿: {target_board['name']}",
            "type": "navigation",
            "style": "color: #74c0fc; background: transparent;",
            "navigation": {
                "action": "open_board",
                "board_name": target_board['name'],
                "board_id": target_board['id']
            }
        }
    else:
        # æä¾›å»ºè®®
        suggestions = []
        for board in boards:
            if board_name.lower() in board['name'].lower():
                suggestions.append(board['name'])
        
        error_msg = f"æ‰¾ä¸åˆ°å±•æ¿: {board_name}"
        if suggestions:
            error_msg += f"\nğŸ’¡ æ‚¨æ˜¯å¦åœ¨æ‰¾: {', '.join(suggestions[:3])}"
        
        return {
            "response": error_msg, 
            "type": "error",
            "style": "color: #ff6b6b; background: transparent;"
        }
```

#### ä¿®å¤è¦ç‚¹
- **åˆ†æ­¥éªŒè¯** - å…ˆç²¾ç¡®åŒ¹é…ï¼Œå†å¤§å°å†™ä¸æ•æ„ŸåŒ¹é…
- **æ˜ç¡®çš„é”™è¯¯å¤„ç†** - æ‰¾ä¸åˆ°æ—¶è¿”å›æ˜ç¡®çš„é”™è¯¯ä¿¡æ¯
- **æ™ºèƒ½å»ºè®®** - æä¾›ç›¸ä¼¼åç§°çš„å»ºè®®

### 3. PDF Openå‘½ä»¤ä¿®å¤

#### ä¿®å¤åçš„ä»£ç 
```python
elif action == "open":
    # ... è§£æå‚æ•° ...
    
    # æ£€æŸ¥PDFæ–‡ä»¶æ˜¯å¦å­˜åœ¨
    uploads_dir = "uploads"
    if os.path.exists(uploads_dir):
        available_pdfs = [f for f in os.listdir(uploads_dir) if f.endswith('.pdf')]
        
        # ç²¾ç¡®åŒ¹é…
        if pdf_name in available_pdfs:
            return {
                "response": f"æ‰“å¼€PDF: {pdf_name}",
                "type": "navigation",
                "style": "color: #74c0fc; background: transparent;",
                "navigation": {
                    "action": "open_pdf",
                    "pdf_name": pdf_name
                }
            }
        
        # ä¸åŒºåˆ†å¤§å°å†™çš„åŒ¹é…
        for pdf in available_pdfs:
            if pdf.lower() == pdf_name.lower():
                return {
                    "response": f"æ‰“å¼€PDF: {pdf}",
                    "type": "navigation", 
                    "style": "color: #74c0fc; background: transparent;",
                    "navigation": {
                        "action": "open_pdf",
                        "pdf_name": pdf
                    }
                }
        
        # æä¾›å»ºè®®
        suggestions = []
        for pdf in available_pdfs:
            if pdf_name.lower() in pdf.lower():
                suggestions.append(pdf)
        
        error_msg = f"æ‰¾ä¸åˆ°PDFæ–‡ä»¶: {pdf_name}"
        if suggestions:
            error_msg += f"\nğŸ’¡ æ‚¨æ˜¯å¦åœ¨æ‰¾: {', '.join(suggestions[:3])}"
        
        return {
            "response": error_msg, 
            "type": "error",
            "style": "color: #ff6b6b; background: transparent;"
        }
    else:
        return {
            "response": "PDFä¸Šä¼ ç›®å½•ä¸å­˜åœ¨", 
            "type": "error",
            "style": "color: #ff6b6b; background: transparent;"
        }
```

#### ä¿®å¤è¦ç‚¹
- **çœŸå®æ–‡ä»¶ç³»ç»ŸéªŒè¯** - æ£€æŸ¥uploadsç›®å½•ä¸­çš„å®é™…PDFæ–‡ä»¶
- **åˆ†æ­¥åŒ¹é…ç­–ç•¥** - ç²¾ç¡®åŒ¹é… â†’ å¤§å°å†™ä¸æ•æ„ŸåŒ¹é… â†’ å»ºè®®
- **ç›®å½•å­˜åœ¨æ€§æ£€æŸ¥** - ç¡®ä¿uploadsç›®å½•å­˜åœ¨

## æµ‹è¯•éªŒè¯

### æµ‹è¯•1: ä¸å­˜åœ¨èµ„æºçš„éªŒè¯

```bash
# æµ‹è¯•ä¸å­˜åœ¨çš„è¯¾ç¨‹
cd ä¸å­˜åœ¨çš„è¯¾ç¨‹123
# ç»“æœ: âœ… æ­£ç¡®æ‹’ç»: æ‰¾ä¸åˆ°ç›®å½•: ä¸å­˜åœ¨çš„è¯¾ç¨‹123

# æµ‹è¯•ä¸å­˜åœ¨çš„å±•æ¿
board open ä¸å­˜åœ¨çš„å±•æ¿789
# ç»“æœ: âœ… æ­£ç¡®æ‹’ç»: æ‰¾ä¸åˆ°å±•æ¿: ä¸å­˜åœ¨çš„å±•æ¿789

# æµ‹è¯•ä¸å­˜åœ¨çš„PDF
pdf open ä¸å­˜åœ¨çš„æ–‡ä»¶.pdf
# ç»“æœ: âœ… æ­£ç¡®æ‹’ç»: æ‰¾ä¸åˆ°PDFæ–‡ä»¶: ä¸å­˜åœ¨çš„æ–‡ä»¶.pdf
```

### æµ‹è¯•2: åœ¨æ­£ç¡®ä½ç½®åˆ›å»ºå±•æ¿

```bash
# åœ¨æ ¹ç›®å½•åˆ›å»ºå±•æ¿
board create æµ‹è¯•æ ¹ç›®å½•å±•æ¿
# ç»“æœ: âœ… å±•æ¿ 'æµ‹è¯•æ ¹ç›®å½•å±•æ¿' åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºæˆåŠŸ

# åœ¨é—ä¼ å­¦è¯¾ç¨‹ä¸­åˆ›å»ºå±•æ¿
cd é—ä¼ å­¦
board create æ§åˆ¶å°æµ‹è¯•å±•æ¿
# ç»“æœ: âœ… å±•æ¿ 'æ§åˆ¶å°æµ‹è¯•å±•æ¿' åœ¨è¯¾ç¨‹ 'é—ä¼ å­¦' ä¸‹åˆ›å»ºæˆåŠŸ
```

### æµ‹è¯•3: è™šå‡è·¯å¾„æ‹’ç»

```bash
# åœ¨ä¸å­˜åœ¨çš„è¯¾ç¨‹è·¯å¾„ä¸‹åˆ›å»ºå±•æ¿
# (current_pathæ˜¾ç¤ºåœ¨'ä¸å­˜åœ¨çš„è¯¾ç¨‹'ä¸­)
board create æµ‹è¯•å‡è¯¾ç¨‹å±•æ¿
# ç»“æœ: âœ… æ­£ç¡®æ‹’ç»: é”™è¯¯ï¼šå½“å‰è¯¾ç¨‹ 'ä¸å­˜åœ¨çš„è¯¾ç¨‹' ä¸å­˜åœ¨ï¼Œæ— æ³•åˆ›å»ºå±•æ¿
```

## ä¿®å¤æ•ˆæœ

### âœ… è§£å†³çš„é—®é¢˜

1. **çœŸå®æ€§éªŒè¯** - æ‰€æœ‰å¯¼èˆªå’Œæ‰“å¼€å‘½ä»¤ç°åœ¨éƒ½ä¼šéªŒè¯ç›®æ ‡æ˜¯å¦çœŸå®å­˜åœ¨
2. **ä¸Šä¸‹æ–‡æ„ŸçŸ¥åˆ›å»º** - åˆ›å»ºå±•æ¿æ—¶æ­£ç¡®ä½¿ç”¨å½“å‰è·¯å¾„ä¸Šä¸‹æ–‡
3. **ç²¾ç¡®é”™è¯¯ä¿¡æ¯** - æ‰¾ä¸åˆ°èµ„æºæ—¶æä¾›æ˜ç¡®çš„é”™è¯¯ä¿¡æ¯å’Œå»ºè®®
4. **ä½ç½®æ˜ç¡®æ€§** - åˆ›å»ºæ“ä½œæ˜ç¡®è¯´æ˜åœ¨å“ªä¸ªä½ç½®åˆ›å»ºäº†èµ„æº

### ğŸ”§ æŠ€æœ¯æ”¹è¿›

1. **è·¯å¾„ä¸Šä¸‹æ–‡ä¼ é€’** - æ‰€æœ‰ç›¸å…³å‘½ä»¤æ­£ç¡®æ¥æ”¶å’Œä½¿ç”¨`current_path`å‚æ•°
2. **åˆ†å±‚éªŒè¯é€»è¾‘** - ç²¾ç¡®åŒ¹é… â†’ å¤§å°å†™ä¸æ•æ„Ÿ â†’ æ¨¡ç³Šå»ºè®®
3. **å­˜åœ¨æ€§åŒé‡æ£€æŸ¥** - æ—¢æ£€æŸ¥å†…å­˜çŠ¶æ€åˆéªŒè¯å®é™…æ–‡ä»¶ç³»ç»Ÿ
4. **æ™ºèƒ½é”™è¯¯å¤„ç†** - æä¾›æœ‰ç”¨çš„å»ºè®®è€Œä¸æ˜¯ç®€å•çš„å¤±è´¥æ¶ˆæ¯

## æ€»ç»“

æœ¬æ¬¡ä¿®å¤å½»åº•è§£å†³äº†ç”¨æˆ·åé¦ˆçš„è™šå‡å¯¼èˆªå’Œé”™è¯¯åˆ›å»ºä½ç½®é—®é¢˜ã€‚ç°åœ¨çš„æ§åˆ¶å°ç³»ç»Ÿèƒ½å¤Ÿï¼š

- **å¦‚å®åæ˜ ç³»ç»ŸçŠ¶æ€** - ä¸å­˜åœ¨çš„èµ„æºä¼šè¢«æ˜ç¡®æ‹’ç»
- **åœ¨æ­£ç¡®ä½ç½®åˆ›å»ºèµ„æº** - æ ¹æ®å½“å‰è·¯å¾„ä¸Šä¸‹æ–‡åˆ›å»ºå±•æ¿
- **æä¾›æœ‰ç”¨çš„åé¦ˆ** - æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯å’Œæ™ºèƒ½å»ºè®®
- **ä¿æŒä¸€è‡´çš„è¡Œä¸º** - æ‰€æœ‰å‘½ä»¤éƒ½éµå¾ªç›¸åŒçš„éªŒè¯åŸåˆ™

è¿™ç¡®ä¿äº†ç”¨æˆ·æ“ä½œçš„å¯é¢„æµ‹æ€§å’Œç³»ç»ŸçŠ¶æ€çš„ä¸€è‡´æ€§ã€‚ 