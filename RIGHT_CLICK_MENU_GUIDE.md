# WhatNote 右键菜单使用指南

## 概述

WhatNote现在支持在展板界面使用右键菜单快速访问专家LLM功能。这个功能让你可以在任何展板区域（除顶栏、侧栏和状态栏外）右键点击，快速打开专家LLM对话窗口。

## 功能特点

### 🎯 智能区域识别
- **展板区域**: 主要工作区域，显示完整的展板功能菜单
- **PDF查看器**: PDF文档区域，显示PDF相关的专用菜单
- **笔记编辑器**: 笔记编辑区域，显示笔记相关的操作菜单
- **侧边栏**: 课程管理区域，显示课程和文件管理菜单

### 🤖 专家LLM集成
- 在展板区域右键点击可快速访问"问专家LLM"选项
- 支持多个展板的独立专家LLM实例
- 自动根据当前活跃展板选择正确的专家LLM

## 使用方法

### 1. 在展板区域右键点击

在主要工作区域（展板背景、空白区域）右键点击，会看到以下菜单选项：

```
🤖 问专家LLM          # 突出显示，蓝色背景
───────────────────
📁 上传PDF文件
📝 打开展板笔记
───────────────────
🔄 刷新展板
```

### 2. 点击"问专家LLM"

点击后会：
- 打开专家LLM对话窗口
- 自动关联到当前展板
- 可以开始与专家AI进行对话

### 3. 多展板支持

- 每个课程/展板都有独立的专家LLM实例
- 右键菜单会自动识别当前展板ID
- 支持在不同展板间切换对话

## 技术实现

### 展板区域标识

主内容区域通过以下属性标识为展板区域：
```html
<Content 
  className="board-area"
  data-board-id="file-course-9-1"
  data-board-name="Course Name"
>
```

### 菜单命令处理

右键菜单通过`ask_expert_llm`命令触发专家LLM对话窗口：
```javascript
case 'ask_expert_llm':
  setExpertWindowVisible(true);
  setCurrentExpertBoardId(boardId);
  break;
```

### 样式增强

"问专家LLM"选项具有特殊的视觉效果：
- 蓝色渐变背景
- 左侧蓝色边框
- 图标脉冲动画
- 悬停时的阴影效果

## 故障排除

### 问题1: 右键菜单不显示
**原因**: 可能点击在了顶栏、侧栏或状态栏区域
**解决**: 确保在主要工作区域（展板背景）右键点击

### 问题2: 没有"问专家LLM"选项
**原因**: 区域识别错误或展板ID缺失
**解决**: 
1. 检查是否在正确的展板区域
2. 确保已经选择了课程文件
3. 刷新页面重试

### 问题3: 专家LLM窗口无法打开
**原因**: 后端API连接问题
**解决**:
1. 检查后端服务是否运行 (localhost:8000)
2. 查看浏览器控制台错误信息
3. 运行测试脚本验证API功能

## 测试方法

可以运行测试脚本验证功能：

```bash
python test_context_menu.py
```

测试会验证：
- 服务器连接状态
- 多个展板的API响应
- 专家LLM问答功能

## 快捷键支持（计划中）

未来版本可能增加：
- `Ctrl + Q`: 快速打开专家LLM
- `Ctrl + Shift + Q`: 在新窗口打开专家LLM
- `Esc`: 关闭右键菜单

## 更新日志

### v1.0 (当前版本)
- ✅ 基础右键菜单功能
- ✅ 展板区域智能识别
- ✅ 专家LLM快速访问
- ✅ 视觉效果增强
- ✅ 多展板支持
- ✅ 回退机制（默认展板）

### 计划功能
- 🔄 更多右键菜单选项
- 🔄 自定义菜单项
- 🔄 快捷键支持
- 🔄 手势识别（移动端） 